From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Ytnoos <aleytnoos12@gmail.com>
Date: Sat, 28 Nov 2020 13:48:10 +0100
Subject: [PATCH] (FlamePaper) Fix NullPointerException exploits for invalid
 logins

Original code by 2lstudios-mc, licensed under MIT
You can find the original code on https://github.com/2lstudios-mc/FlamePaper

diff --git a/src/main/java/net/minecraft/server/network/LoginListener.java b/src/main/java/net/minecraft/server/network/LoginListener.java
index 25437a993c02379fa43e5d46159cd9ba2aebf10f..b7b63587ce6a389dab15bf8a49b078579637dccc 100644
--- a/src/main/java/net/minecraft/server/network/LoginListener.java
+++ b/src/main/java/net/minecraft/server/network/LoginListener.java
@@ -199,7 +199,8 @@ public class LoginListener implements PacketLoginInListener {
     }
 
     public String d() {
-        return this.i != null ? this.i + " (" + this.networkManager.getSocketAddress() + ")" : String.valueOf(this.networkManager.getSocketAddress());
+        String socketAddress = networkManager == null ? null : (networkManager.getSocketAddress() == null ? null : networkManager.getSocketAddress().toString());
+        return this.i != null ? this.i + " (" + socketAddress + ")" : socketAddress;
     }
 
     @Override
