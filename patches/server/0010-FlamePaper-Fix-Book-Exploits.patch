From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: linsaftw <linsaftw@users.noreply.github.com>
Date: Sun, 25 Apr 2021 11:53:18 -0300
Subject: [PATCH] (FlamePaper) Fix Book Exploits

Original code by 2lstudios-mc, licensed under MIT
You can find the original code on https://github.com/2lstudios-mc/FlamePaper

diff --git a/src/main/java/net/minecraft/network/PacketDataSerializer.java b/src/main/java/net/minecraft/network/PacketDataSerializer.java
index 579eb1260c7266cd41025cff177de4fb00ac0cec..7f2bb14b8a19a499589cb666b0e307f7e3380ed4 100644
--- a/src/main/java/net/minecraft/network/PacketDataSerializer.java
+++ b/src/main/java/net/minecraft/network/PacketDataSerializer.java
@@ -274,7 +274,7 @@ public class PacketDataSerializer extends ByteBuf {
 
     @Nullable
     public NBTTagCompound l() {
-        return this.a(new NBTReadLimiter(2097152L));
+        return this.a(new NBTReadLimiter(64000L)); // FlamePaper - Reduce NBT read limit
     }
 
     @Nullable
